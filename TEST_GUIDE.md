# FreeCut 插件测试指南

## 测试环境准备

### 系统要求
- Windows 10/11
- Microsoft PowerPoint 2016或更高版本
- .NET 6.0 Runtime

### 安装步骤
1. 运行 `build.bat` 编译项目
2. 以管理员身份运行 `install.ps1` 安装插件
3. 重启PowerPoint

## 功能测试清单

### ✅ 1. 插件加载测试

**测试目标**: 验证插件是否正确加载到PowerPoint中

**操作步骤**:
1. 启动PowerPoint
2. 检查功能区是否出现"FreeCut"标签页
3. 点击"FreeCut"标签页

**预期结果**:
- [x] FreeCut标签页正常显示
- [x] 标签页包含"PDF导出"、"设置"、"帮助"三个组
- [x] 各按钮图标和文字正确显示

---

### ✅ 2. 基本界面测试

**测试目标**: 验证各个界面元素是否正常工作

#### 2.1 关于对话框
**操作**: 点击"关于"按钮
**预期**: 显示插件版本信息和使用说明

#### 2.2 设置界面
**操作**: 点击"裁剪设置"按钮
**预期**:
- [x] 设置窗口正常打开
- [x] 所有数值输入框可以正常输入
- [x] 复选框可以正常勾选/取消
- [x] "确定"、"取消"、"重置"按钮正常工作

---

### ✅ 3. 页面选择测试

**测试目标**: 验证插件是否能正确识别选中的幻灯片

**测试数据**: 创建包含3-5页内容的PPT文件

**操作步骤**:
1. 在幻灯片面板选择单个幻灯片
2. 检查"导出PDF"和"预览裁剪"按钮状态
3. 选择多个幻灯片（Ctrl+点击）
4. 再次检查按钮状态

**预期结果**:
- [x] 选择幻灯片后，"导出PDF"按钮启用
- [x] 选择幻灯片后，"预览裁剪"按钮启用
- [x] 未选择幻灯片时，相关按钮禁用

---

### ✅ 4. 预览功能测试

**测试目标**: 验证裁剪预览是否正确显示

**测试数据**:
- 包含文字和图片的幻灯片
- 有明显边距的幻灯片
- 纯色背景的幻灯片

**操作步骤**:
1. 选择一张幻灯片
2. 点击"预览裁剪"按钮
3. 观察预览效果

**预期结果**:
- [x] 预览窗口正常打开
- [x] 显示原始图片
- [x] 红色虚线框标明裁剪区域
- [x] 裁剪区域外有半透明遮罩
- [x] 底部显示尺寸和模式信息

#### 4.1 自动检测模式测试
**操作**:
1. 在设置中启用"自动检测边界"
2. 预览不同类型的幻灯片

**预期**: 自动检测到内容边界，适当裁剪空白区域

#### 4.2 固定边距模式测试
**操作**:
1. 禁用"自动检测边界"
2. 设置不同的边距值
3. 预览效果

**预期**: 按设定边距进行固定裁剪

---

### ✅ 5. PDF导出测试

**测试目标**: 验证PDF导出功能是否正常工作

**测试数据**:
- 单页幻灯片
- 多页幻灯片（3-5页）
- 包含复杂内容的幻灯片

#### 5.1 单页导出测试
**操作步骤**:
1. 选择一张幻灯片
2. 点击"导出PDF"
3. 选择保存位置
4. 等待导出完成

**预期结果**:
- [x] 进度条正常显示
- [x] PDF文件成功生成
- [x] 文件大小合理
- [x] 打开PDF确认内容正确裁剪

#### 5.2 多页导出测试
**操作步骤**:
1. 选择多张幻灯片（Ctrl+点击）
2. 执行导出操作

**预期结果**:
- [x] 所有选中页面都被导出
- [x] PDF页面顺序正确
- [x] 每页裁剪效果一致

#### 5.3 质量设置测试
**操作**:
1. 测试不同的PDF质量设置（30, 60, 90）
2. 测试不同的DPI设置（72, 150, 300）

**预期**: 不同设置下文件大小和清晰度有明显差异

---

### ✅ 6. 设置保存测试

**测试目标**: 验证设置是否能正确保存和加载

**操作步骤**:
1. 修改各项设置参数
2. 点击"确定"保存
3. 重新打开设置界面
4. 重启PowerPoint后再次检查

**预期结果**:
- [x] 设置能正确保存到配置文件
- [x] 重新打开时设置值正确
- [x] 重启应用后设置依然生效

---

### ✅ 7. 错误处理测试

**测试目标**: 验证异常情况的处理是否正确

#### 7.1 无权限测试
**操作**: 选择只读路径保存PDF
**预期**: 显示友好的错误提示

#### 7.2 磁盘空间不足测试
**操作**: 在磁盘空间不足时导出大文件
**预期**: 显示相应错误信息

#### 7.3 无效设置测试
**操作**: 在设置中输入超出范围的值
**预期**: 显示验证错误提示

---

### ✅ 8. 性能测试

**测试目标**: 验证插件在不同负载下的性能表现

#### 8.1 大文件测试
**测试数据**: 包含高分辨率图片的幻灯片
**操作**: 导出高DPI的PDF
**预期**: 能够正常处理，进度提示清晰

#### 8.2 批量导出测试
**测试数据**: 20-30页的演示文稿
**操作**: 选择所有页面导出
**预期**: 能够完成导出，内存使用合理

---

### ✅ 9. 兼容性测试

**测试目标**: 验证在不同PowerPoint版本和文件格式下的兼容性

**测试环境**:
- PowerPoint 2016, 2019, 365
- .pptx, .ppt 格式文件

**预期**: 所有支持的版本和格式都能正常工作

---

## 回归测试

在修改代码后，执行以下快速回归测试：

1. **快速功能验证** (5分钟)
   - 插件加载 ✓
   - 设置界面打开 ✓
   - 单页预览 ✓
   - 单页导出 ✓

2. **核心功能验证** (10分钟)
   - 自动检测裁剪 ✓
   - 固定边距裁剪 ✓
   - 多页导出 ✓
   - 设置保存 ✓

## 测试报告模板

### 测试环境
- 操作系统: Windows 10/11
- PowerPoint版本: 2019
- 插件版本: 1.0.0
- 测试日期: YYYY-MM-DD

### 测试结果汇总
- 通过测试: X/Y
- 失败测试: 0
- 阻塞问题: 0

### 问题记录
| 编号 | 问题描述 | 严重程度 | 状态 |
|------|----------|----------|------|
| 1    | 描述     | 高/中/低 | 待修复 |

### 总体评价
插件功能完整，性能良好，可以发布。

---

**注意**: 测试过程中如发现问题，请详细记录复现步骤和环境信息，以便开发团队快速定位和修复。